{"version":3,"sources":["../app.js"],"names":["require","module","exports","app","beforeStart","logger","info","config","discription","secret","ctx","createAnonymousContext","mysql","modify","service","initalDatabase","inital","once","server","entity","entityCache","restful","reflashEntity","messenger","on","data","invokeEntitys"],"mappings":"AAAA;;;;AACAA,QAAQ,YAAR;AACAA,QAAQ,gBAAR;;AAEAC,OAAOC,OAAP,GAAiB,eAAO;AACpBC,QAAIC,WAAJ,yDAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AACZ;AACAD,4BAAIE,MAAJ,CAAWC,IAAX,CAAgB,UAAhB;AACAH,4BAAIE,MAAJ,CAAWC,IAAX,CAAgBH,IAAII,MAAJ,CAAWC,WAA3B;;AAGAL,4BAAIM,MAAJ,GAAa,UAAb;AACMC,2BAPM,GAOAP,IAAIQ,sBAAJ,EAPA;;;AASZR,4BAAIS,KAAJ,CAAUC,MAAV,GAAiB,KAAjB;AACA;AAVY;AAAA,+BAWNH,IAAII,OAAJ,CAAYC,cAAZ,CAA2BC,MAA3B,EAXM;;AAAA;;AAaZb,4BAAIE,MAAJ,CAAWC,IAAX,CAAgB,iBAAhB;;AAbY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAhB;;AAiBAH,QAAIc,IAAJ,CAAS,QAAT;AAAA,4EAAmB,kBAAMC,MAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACTR,+BADS,GACHP,IAAIQ,sBAAJ,EADG;AAEf;;AAFe;AAAA,mCAGTD,IAAII,OAAJ,CAAYK,MAAZ,CAAmBC,WAAnB,EAHS;;AAAA;AAAA;AAAA,mCAKTV,IAAII,OAAJ,CAAYO,OAAZ,CAAoBC,aAApB,EALS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAnB;;AAAA;AAAA;AAAA;AAAA;;AAQA;AACAnB,QAAIoB,SAAJ,CAAcC,EAAd,CAAiB,aAAjB;AAAA,4EAAgC,kBAAMC,IAAN;AAAA;AAAA;AAAA;AAAA;AAC5BtB,gCAAIiB,WAAJ,GAAgBK,IAAhB;;AAD4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAhC;;AAAA;AAAA;AAAA;AAAA;;AAIAtB,QAAIoB,SAAJ,CAAcC,EAAd,CAAiB,eAAjB,EAAkC,gBAAQ;AACtCrB,YAAIuB,aAAJ,GAAkBD,IAAlB;AACH,KAFD;AAGH,CAlCD","file":"app.js","sourcesContent":["'use strict';\nrequire('./app/util');\nrequire(\"babel-register\");\n\nmodule.exports = app => {\n    app.beforeStart(async () => {\n        // 应用会等待这个函数执行完成才启动\n        app.logger.info('init app');\n        app.logger.info(app.config.discription);\n\n\n        app.secret = 'n7d3t7x7';\n        const ctx = app.createAnonymousContext();\n\n        app.mysql.modify=false;\n        //初始化数据库\n        await ctx.service.initalDatabase.inital();\n\n        app.logger.info('app started!!!!');\n\n    });\n\n    app.once('server', async server => {\n        const ctx = app.createAnonymousContext();\n        //实体配置缓存\n        await ctx.service.entity.entityCache();\n        //接口调用缓存\n        await ctx.service.restful.reflashEntity();\n    });\n\n    //实体配置信息缓存\n    app.messenger.on('entityCache', async data => {\n        app.entityCache=data;\n    });\n\n    app.messenger.on('invokeEntitys', data => {\n        app.invokeEntitys=data;\n    });\n};\n\n\n\n\n\n\n\n"]}